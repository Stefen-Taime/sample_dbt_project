

============================== 2023-04-01 17:39:10.735546 | e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380 ==============================
[0m17:39:10.735546 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:39:10.737532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': True, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m17:39:10.737902 [debug] [MainThread]: Tracking: tracking
[0m17:39:10.781401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8764a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8764ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8764a7c0>]}
[0m17:39:10.797089 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:39:10.797851 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:39:10.798373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8764af10>]}
[0m17:39:11.861277 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:39:11.883008 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:39:12.035264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86e96d30>]}
[0m17:39:12.045832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86eecd00>]}
[0m17:39:12.046464 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:39:12.047016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86e8fc70>]}
[0m17:39:12.048748 [info ] [MainThread]: 
[0m17:39:12.050898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:39:12.052443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:39:12.070557 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:39:12.070965 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:39:12.071303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:12.084805 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:39:12.086081 [debug] [ThreadPool]: On list_postgres: Close
[0m17:39:12.087805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:39:12.103522 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:39:12.103905 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:39:12.104235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:12.115388 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:39:12.115836 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:39:12.116126 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:39:12.118512 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m17:39:12.120098 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:39:12.120940 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:39:12.175614 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:12.176478 [debug] [MainThread]: On master: BEGIN
[0m17:39:12.176998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:12.187153 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:39:12.187662 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:12.188152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:39:12.191302 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:39:12.193343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed876bac70>]}
[0m17:39:12.193962 [debug] [MainThread]: On master: ROLLBACK
[0m17:39:12.194755 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:12.195133 [debug] [MainThread]: On master: BEGIN
[0m17:39:12.196489 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:39:12.196920 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.197326 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:12.197704 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.198421 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:39:12.198834 [debug] [MainThread]: On master: Close
[0m17:39:12.199686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:12.200241 [info ] [MainThread]: 
[0m17:39:12.203720 [debug] [Thread-1  ]: Began running node seed.sample_dbt.chansons
[0m17:39:12.204224 [info ] [Thread-1  ]: 1 of 2 START seed file public.chansons ......................................... [RUN]
[0m17:39:12.205379 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.sample_dbt.chansons'
[0m17:39:12.205780 [debug] [Thread-1  ]: Began compiling node seed.sample_dbt.chansons
[0m17:39:12.206142 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.chansons (compile): 2023-04-01 17:39:12.206028 => 2023-04-01 17:39:12.206033
[0m17:39:12.206470 [debug] [Thread-1  ]: Began executing node seed.sample_dbt.chansons
[0m17:39:12.313791 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.chansons"
[0m17:39:12.314132 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: BEGIN
[0m17:39:12.314423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:39:12.325613 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:39:12.326044 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.chansons"
[0m17:39:12.326303 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "seed.sample_dbt.chansons"} */

    create table "postgres"."public"."chansons" ("id_utilisateur" integer,"titre" text,"artiste" text,"duree_sec" integer,"genre" text,"date_ecoute" date,"nombre_ecoutes" integer)
  
[0m17:39:12.332560 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0 seconds
[0m17:39:13.712588 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.chansons"
[0m17:39:13.712925 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: 
          insert into "postgres"."public"."chansons" ("id_utilisateur", "titre", "artiste", "duree_sec", "genre", "date_ecoute", "nombre_ecoutes") values
          (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m17:39:13.725850 [debug] [Thread-1  ]: SQL status: INSERT 0 500 in 0 seconds
[0m17:39:13.734577 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sample_dbt.chansons"
[0m17:39:13.767233 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: COMMIT
[0m17:39:13.767550 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.chansons"
[0m17:39:13.767861 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: COMMIT
[0m17:39:13.769771 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:39:13.772015 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.chansons (execute): 2023-04-01 17:39:12.206734 => 2023-04-01 17:39:13.771940
[0m17:39:13.772362 [debug] [Thread-1  ]: On seed.sample_dbt.chansons: Close
[0m17:39:13.773228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86ed6430>]}
[0m17:39:13.773709 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file public.chansons ..................................... [[32mINSERT 500[0m in 1.57s]
[0m17:39:13.776719 [debug] [Thread-1  ]: Finished running node seed.sample_dbt.chansons
[0m17:39:13.777403 [debug] [Thread-1  ]: Began running node seed.sample_dbt.utilisateurs
[0m17:39:13.777887 [info ] [Thread-1  ]: 2 of 2 START seed file public.utilisateurs ..................................... [RUN]
[0m17:39:13.778795 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.sample_dbt.utilisateurs'
[0m17:39:13.779013 [debug] [Thread-1  ]: Began compiling node seed.sample_dbt.utilisateurs
[0m17:39:13.779195 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.utilisateurs (compile): 2023-04-01 17:39:13.779146 => 2023-04-01 17:39:13.779148
[0m17:39:13.779373 [debug] [Thread-1  ]: Began executing node seed.sample_dbt.utilisateurs
[0m17:39:13.786809 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.utilisateurs"
[0m17:39:13.787543 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: BEGIN
[0m17:39:13.787919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:39:13.803065 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:39:13.803521 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.utilisateurs"
[0m17:39:13.804165 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "seed.sample_dbt.utilisateurs"} */

    create table "postgres"."public"."utilisateurs" ("id_utilisateur" integer,"nom" text,"age" integer,"pays" text)
  
[0m17:39:13.811419 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0 seconds
[0m17:39:13.894377 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.utilisateurs"
[0m17:39:13.894691 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: 
          insert into "postgres"."public"."utilisateurs" ("id_utilisateur", "nom", "age", "pays") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,...
[0m17:39:13.896224 [debug] [Thread-1  ]: SQL status: INSERT 0 50 in 0 seconds
[0m17:39:13.897084 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.sample_dbt.utilisateurs"
[0m17:39:13.899596 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: COMMIT
[0m17:39:13.899843 [debug] [Thread-1  ]: Using postgres connection "seed.sample_dbt.utilisateurs"
[0m17:39:13.900129 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: COMMIT
[0m17:39:13.902363 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:39:13.903103 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.utilisateurs (execute): 2023-04-01 17:39:13.779499 => 2023-04-01 17:39:13.903041
[0m17:39:13.903377 [debug] [Thread-1  ]: On seed.sample_dbt.utilisateurs: Close
[0m17:39:13.904239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9adbc41-cc3b-4a55-a8d0-7f7bfaa1f380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86ed6d90>]}
[0m17:39:13.904647 [info ] [Thread-1  ]: 2 of 2 OK loaded seed file public.utilisateurs ................................. [[32mINSERT 50[0m in 0.13s]
[0m17:39:13.905140 [debug] [Thread-1  ]: Finished running node seed.sample_dbt.utilisateurs
[0m17:39:13.906461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:39:13.906802 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:13.907075 [debug] [MainThread]: On master: BEGIN
[0m17:39:13.907371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:13.916402 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:39:13.916828 [debug] [MainThread]: On master: COMMIT
[0m17:39:13.917109 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:13.917367 [debug] [MainThread]: On master: COMMIT
[0m17:39:13.917913 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:39:13.918203 [debug] [MainThread]: On master: Close
[0m17:39:13.918831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:13.919067 [debug] [MainThread]: Connection 'seed.sample_dbt.utilisateurs' was properly closed.
[0m17:39:13.919358 [info ] [MainThread]: 
[0m17:39:13.919751 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m17:39:13.920546 [debug] [MainThread]: Command end result
[0m17:39:13.930338 [info ] [MainThread]: 
[0m17:39:13.931040 [info ] [MainThread]: Random sample of table: public.chansons
[0m17:39:13.931424 [info ] [MainThread]: ---------------------------------------
[0m17:39:13.937480 [info ] [MainThread]: 
[0m17:39:13.938169 [info ] [MainThread]: 
[0m17:39:13.938740 [info ] [MainThread]: Random sample of table: public.utilisateurs
[0m17:39:13.939155 [info ] [MainThread]: -------------------------------------------
[0m17:39:13.941149 [info ] [MainThread]: 
[0m17:39:13.941630 [info ] [MainThread]: 
[0m17:39:13.942028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:13.942497 [info ] [MainThread]: 
[0m17:39:13.943085 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:39:13.944040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86ea0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86e60850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed86ef6e20>]}
[0m17:39:13.944738 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 17:42:29.086723 | e016958f-89c6-43e8-b7bc-8a559ae7102f ==============================
[0m17:42:29.086723 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:42:29.088664 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:42:29.088932 [debug] [MainThread]: Tracking: tracking
[0m17:42:29.130294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfecc10700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfecc10ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfecc10760>]}
[0m17:42:29.146011 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:42:29.178601 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 1 files changed.
[0m17:42:29.179117 [debug] [MainThread]: Partial parsing: added file: sample_dbt://models/total_ecoutes_par_genre.sql
[0m17:42:29.179610 [debug] [MainThread]: Partial parsing: updated file: sample_dbt://models/example/schema.yml
[0m17:42:29.179878 [debug] [MainThread]: Partial parsing: deleted file: sample_dbt://models/example/my_first_dbt_model.sql
[0m17:42:29.180125 [debug] [MainThread]: Partial parsing: deleted file: sample_dbt://models/example/my_second_dbt_model.sql
[0m17:42:29.215928 [debug] [MainThread]: 1699: static parser successfully parsed total_ecoutes_par_genre.sql
[0m17:42:29.244459 [warn ] [MainThread]: [[33mWARNING[0m]: 'chansons' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `chansons` specification
under the seeds key instead.
[0m17:42:29.246646 [warn ] [MainThread]: [[33mWARNING[0m]: 'utilisateurs' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `utilisateurs`
specification under the seeds key instead.
[0m17:42:29.290381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m17:42:29.298700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e016958f-89c6-43e8-b7bc-8a559ae7102f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec21a850>]}
[0m17:42:29.311024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e016958f-89c6-43e8-b7bc-8a559ae7102f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec22a640>]}
[0m17:42:29.311587 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:42:29.312110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e016958f-89c6-43e8-b7bc-8a559ae7102f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff13065b0>]}
[0m17:42:29.313682 [info ] [MainThread]: 
[0m17:42:29.315903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:42:29.318178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:42:29.338749 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:42:29.339243 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:42:29.339668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:29.352200 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:42:29.355142 [debug] [ThreadPool]: On list_postgres: Close
[0m17:42:29.358667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:42:29.367802 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:42:29.368388 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:42:29.368743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:29.378803 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:42:29.379058 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:42:29.379228 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:42:29.381966 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:42:29.383928 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:42:29.384765 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:42:29.402564 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.403070 [debug] [MainThread]: On master: BEGIN
[0m17:42:29.403471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:29.411923 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:42:29.412394 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.412786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:42:29.415946 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:42:29.417443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e016958f-89c6-43e8-b7bc-8a559ae7102f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec22ad60>]}
[0m17:42:29.417965 [debug] [MainThread]: On master: ROLLBACK
[0m17:42:29.418622 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.419022 [debug] [MainThread]: On master: BEGIN
[0m17:42:29.419997 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:42:29.420403 [debug] [MainThread]: On master: COMMIT
[0m17:42:29.420792 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.421162 [debug] [MainThread]: On master: COMMIT
[0m17:42:29.421782 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:42:29.422191 [debug] [MainThread]: On master: Close
[0m17:42:29.423024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:29.423552 [info ] [MainThread]: 
[0m17:42:29.427130 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m17:42:29.427695 [info ] [Thread-1  ]: 1 of 1 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m17:42:29.428545 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m17:42:29.428865 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m17:42:29.432552 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.433183 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 17:42:29.429092 => 2023-04-01 17:42:29.433100
[0m17:42:29.433500 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m17:42:29.498010 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.498576 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.498863 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m17:42:29.499115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:42:29.509234 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:42:29.509550 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.509813 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m17:42:29.511876 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:42:29.522487 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.522844 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m17:42:29.523663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:42:29.548086 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m17:42:29.548394 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.548625 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m17:42:29.609486 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:42:29.614597 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m17:42:29.614874 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m17:42:29.615477 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:42:29.617049 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 17:42:29.433704 => 2023-04-01 17:42:29.616987
[0m17:42:29.617320 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m17:42:29.618159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e016958f-89c6-43e8-b7bc-8a559ae7102f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec1e9ca0>]}
[0m17:42:29.618640 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.19s]
[0m17:42:29.620363 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m17:42:29.621840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:42:29.622265 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.622530 [debug] [MainThread]: On master: BEGIN
[0m17:42:29.622783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:29.631811 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:42:29.632240 [debug] [MainThread]: On master: COMMIT
[0m17:42:29.632557 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:29.632855 [debug] [MainThread]: On master: COMMIT
[0m17:42:29.633452 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:42:29.633761 [debug] [MainThread]: On master: Close
[0m17:42:29.634630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:29.634899 [debug] [MainThread]: Connection 'model.sample_dbt.total_ecoutes_par_genre' was properly closed.
[0m17:42:29.635221 [info ] [MainThread]: 
[0m17:42:29.635798 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:42:29.636877 [debug] [MainThread]: Command end result
[0m17:42:29.646724 [info ] [MainThread]: 
[0m17:42:29.647330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:29.647816 [info ] [MainThread]: 
[0m17:42:29.648235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:42:29.648828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfecb24490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec166280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfec166b50>]}
[0m17:42:29.649299 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 17:47:20.493438 | edf7377d-1c67-48ad-8df8-c8b477dabaf8 ==============================
[0m17:47:20.493438 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:47:20.495389 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:47:20.495640 [debug] [MainThread]: Tracking: tracking
[0m17:47:20.536073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f31581760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f31581b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f315817c0>]}
[0m17:47:20.552074 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:47:20.588075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:20.588389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:20.589218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m17:47:20.607108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edf7377d-1c67-48ad-8df8-c8b477dabaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3145ff40>]}
[0m17:47:20.619252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edf7377d-1c67-48ad-8df8-c8b477dabaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f314436d0>]}
[0m17:47:20.619701 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:47:20.620175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf7377d-1c67-48ad-8df8-c8b477dabaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f31443a30>]}
[0m17:47:20.621740 [info ] [MainThread]: 
[0m17:47:20.623781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:20.625536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:47:20.645071 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:20.645800 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:47:20.646425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:20.657821 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:47:20.658341 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:20.658750 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:47:20.661640 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m17:47:20.663470 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:47:20.664611 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:47:20.673679 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.674030 [debug] [MainThread]: On master: BEGIN
[0m17:47:20.674416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:20.684097 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:20.684549 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.684885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:20.690259 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:47:20.691368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf7377d-1c67-48ad-8df8-c8b477dabaf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f31443580>]}
[0m17:47:20.691662 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:20.692172 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.692352 [debug] [MainThread]: On master: BEGIN
[0m17:47:20.693240 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:20.693528 [debug] [MainThread]: On master: COMMIT
[0m17:47:20.693793 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.694043 [debug] [MainThread]: On master: COMMIT
[0m17:47:20.694611 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:47:20.694906 [debug] [MainThread]: On master: Close
[0m17:47:20.695586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:20.696021 [info ] [MainThread]: 
[0m17:47:20.699811 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:20.700395 [info ] [Thread-1  ]: 1 of 4 START test not_null_chansons_id_utilisateur ............................. [RUN]
[0m17:47:20.701226 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14'
[0m17:47:20.701563 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:20.719933 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:20.721034 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (compile): 2023-04-01 17:47:20.701786 => 2023-04-01 17:47:20.720939
[0m17:47:20.721543 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:20.746305 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:20.747249 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:20.747588 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: BEGIN
[0m17:47:20.747946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:20.758379 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:20.758732 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:20.758998 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."chansons"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:47:20.759998 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:20.762592 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (execute): 2023-04-01 17:47:20.721877 => 2023-04-01 17:47:20.762518
[0m17:47:20.763048 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: ROLLBACK
[0m17:47:20.763595 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: Close
[0m17:47:20.764704 [info ] [Thread-1  ]: 1 of 4 PASS not_null_chansons_id_utilisateur ................................... [[32mPASS[0m in 0.06s]
[0m17:47:20.766719 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:20.767557 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:20.768477 [info ] [Thread-1  ]: 2 of 4 START test not_null_utilisateurs_id_utilisateur ......................... [RUN]
[0m17:47:20.769425 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626'
[0m17:47:20.769746 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:20.776094 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:20.776611 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (compile): 2023-04-01 17:47:20.769998 => 2023-04-01 17:47:20.776542
[0m17:47:20.776962 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:20.781166 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:20.782195 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:20.782517 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: BEGIN
[0m17:47:20.782836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:20.792872 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:20.793193 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:20.793463 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."utilisateurs"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:47:20.794422 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:20.796430 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (execute): 2023-04-01 17:47:20.777268 => 2023-04-01 17:47:20.796347
[0m17:47:20.796770 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: ROLLBACK
[0m17:47:20.797631 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: Close
[0m17:47:20.798889 [info ] [Thread-1  ]: 2 of 4 PASS not_null_utilisateurs_id_utilisateur ............................... [[32mPASS[0m in 0.03s]
[0m17:47:20.799825 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:20.801360 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:20.801881 [info ] [Thread-1  ]: 3 of 4 START test unique_chansons_id_utilisateur ............................... [RUN]
[0m17:47:20.803194 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef'
[0m17:47:20.803632 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:20.814782 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:20.815383 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef (compile): 2023-04-01 17:47:20.804507 => 2023-04-01 17:47:20.815273
[0m17:47:20.815920 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:20.819943 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:20.820530 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:20.820830 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: BEGIN
[0m17:47:20.821140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:20.831324 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:20.831797 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:20.832259 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_utilisateur as unique_field,
    count(*) as n_records

from "postgres"."public"."chansons"
where id_utilisateur is not null
group by id_utilisateur
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:20.834947 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:20.837037 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef (execute): 2023-04-01 17:47:20.816179 => 2023-04-01 17:47:20.836961
[0m17:47:20.837343 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: ROLLBACK
[0m17:47:20.837999 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: Close
[0m17:47:20.838804 [error] [Thread-1  ]: 3 of 4 FAIL 50 unique_chansons_id_utilisateur .................................. [[31mFAIL 50[0m in 0.04s]
[0m17:47:20.839296 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:20.839697 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:20.840023 [info ] [Thread-1  ]: 4 of 4 START test unique_utilisateurs_id_utilisateur ........................... [RUN]
[0m17:47:20.841033 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031'
[0m17:47:20.841343 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:20.847172 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:20.847741 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (compile): 2023-04-01 17:47:20.841583 => 2023-04-01 17:47:20.847644
[0m17:47:20.848255 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:20.852164 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:20.852965 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:20.853382 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: BEGIN
[0m17:47:20.853800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:20.865292 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:20.865675 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:20.865974 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_utilisateur as unique_field,
    count(*) as n_records

from "postgres"."public"."utilisateurs"
where id_utilisateur is not null
group by id_utilisateur
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:20.868841 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:20.870787 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (execute): 2023-04-01 17:47:20.848565 => 2023-04-01 17:47:20.870683
[0m17:47:20.871128 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: ROLLBACK
[0m17:47:20.871752 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: Close
[0m17:47:20.872661 [info ] [Thread-1  ]: 4 of 4 PASS unique_utilisateurs_id_utilisateur ................................. [[32mPASS[0m in 0.03s]
[0m17:47:20.873156 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:20.874629 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:20.874951 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.875223 [debug] [MainThread]: On master: BEGIN
[0m17:47:20.875495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:20.885460 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:20.885920 [debug] [MainThread]: On master: COMMIT
[0m17:47:20.886277 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:20.886564 [debug] [MainThread]: On master: COMMIT
[0m17:47:20.887331 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:47:20.887683 [debug] [MainThread]: On master: Close
[0m17:47:20.888926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:20.889241 [debug] [MainThread]: Connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031' was properly closed.
[0m17:47:20.889517 [info ] [MainThread]: 
[0m17:47:20.889990 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:47:20.890668 [debug] [MainThread]: Command end result
[0m17:47:20.898994 [info ] [MainThread]: 
[0m17:47:20.899984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:47:20.901057 [info ] [MainThread]: 
[0m17:47:20.901792 [error] [MainThread]: [31mFailure in test unique_chansons_id_utilisateur (models/example/schema.yml)[0m
[0m17:47:20.902233 [error] [MainThread]:   Got 50 results, configured to fail if != 0
[0m17:47:20.903675 [info ] [MainThread]: 
[0m17:47:20.904181 [info ] [MainThread]:   compiled Code at target/compiled/sample_dbt/models/example/schema.yml/unique_chansons_id_utilisateur.sql
[0m17:47:20.904589 [info ] [MainThread]: 
[0m17:47:20.905152 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:47:20.905879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f314146a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f31443580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f30bcb220>]}
[0m17:47:20.906301 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 17:47:39.949831 | ca06f0e6-b7a3-4327-bff1-94f29074615f ==============================
[0m17:47:39.949831 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:47:39.951650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:47:39.952055 [debug] [MainThread]: Tracking: tracking
[0m17:47:39.996395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4041d66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4041d6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4041d6730>]}
[0m17:47:40.010910 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:47:40.043741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:40.044156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:40.045056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m17:47:40.053458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca06f0e6-b7a3-4327-bff1-94f29074615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4040a1eb0>]}
[0m17:47:40.063056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca06f0e6-b7a3-4327-bff1-94f29074615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb404085640>]}
[0m17:47:40.063578 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:47:40.064251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca06f0e6-b7a3-4327-bff1-94f29074615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb404085940>]}
[0m17:47:40.066299 [info ] [MainThread]: 
[0m17:47:40.068729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:40.070648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:47:40.089768 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:40.090131 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:47:40.090420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:40.101471 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:47:40.101860 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:47:40.102142 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:47:40.105243 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m17:47:40.107100 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:47:40.107750 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:47:40.125644 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.125987 [debug] [MainThread]: On master: BEGIN
[0m17:47:40.126399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:40.135215 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:40.135549 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.135863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:40.140743 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:47:40.142326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca06f0e6-b7a3-4327-bff1-94f29074615f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb404085790>]}
[0m17:47:40.142717 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:40.143306 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.143582 [debug] [MainThread]: On master: BEGIN
[0m17:47:40.144282 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:40.144560 [debug] [MainThread]: On master: COMMIT
[0m17:47:40.144828 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.145076 [debug] [MainThread]: On master: COMMIT
[0m17:47:40.145649 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:47:40.145963 [debug] [MainThread]: On master: Close
[0m17:47:40.146729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:40.147116 [info ] [MainThread]: 
[0m17:47:40.150676 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:40.151049 [info ] [Thread-1  ]: 1 of 4 START test not_null_chansons_id_utilisateur ............................. [RUN]
[0m17:47:40.152219 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14'
[0m17:47:40.152522 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:40.172370 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:40.173005 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (compile): 2023-04-01 17:47:40.152738 => 2023-04-01 17:47:40.172909
[0m17:47:40.173422 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:40.196571 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:40.197168 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:40.197455 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: BEGIN
[0m17:47:40.197687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:40.206885 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:40.207215 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:47:40.207474 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."chansons"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:47:40.208701 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:40.211368 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (execute): 2023-04-01 17:47:40.173674 => 2023-04-01 17:47:40.211301
[0m17:47:40.211681 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: ROLLBACK
[0m17:47:40.212289 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: Close
[0m17:47:40.212874 [info ] [Thread-1  ]: 1 of 4 PASS not_null_chansons_id_utilisateur ................................... [[32mPASS[0m in 0.06s]
[0m17:47:40.214487 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:47:40.214885 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:40.215275 [info ] [Thread-1  ]: 2 of 4 START test not_null_utilisateurs_id_utilisateur ......................... [RUN]
[0m17:47:40.216383 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626'
[0m17:47:40.216688 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:40.223270 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:40.223958 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (compile): 2023-04-01 17:47:40.216841 => 2023-04-01 17:47:40.223739
[0m17:47:40.224295 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:40.227319 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:40.227776 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:40.228083 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: BEGIN
[0m17:47:40.228309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:40.237737 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:40.238118 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:47:40.238400 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."utilisateurs"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:47:40.239551 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:40.241598 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (execute): 2023-04-01 17:47:40.224519 => 2023-04-01 17:47:40.241484
[0m17:47:40.242034 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: ROLLBACK
[0m17:47:40.242672 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: Close
[0m17:47:40.243562 [info ] [Thread-1  ]: 2 of 4 PASS not_null_utilisateurs_id_utilisateur ............................... [[32mPASS[0m in 0.03s]
[0m17:47:40.244392 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:47:40.244791 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:40.245075 [info ] [Thread-1  ]: 3 of 4 START test unique_chansons_id_utilisateur ............................... [RUN]
[0m17:47:40.246195 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef'
[0m17:47:40.246621 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:40.258421 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:40.258947 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef (compile): 2023-04-01 17:47:40.246980 => 2023-04-01 17:47:40.258880
[0m17:47:40.259318 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:40.262392 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:40.262951 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:40.263294 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: BEGIN
[0m17:47:40.263654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:40.274110 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:40.274716 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"
[0m17:47:40.275137 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_utilisateur as unique_field,
    count(*) as n_records

from "postgres"."public"."chansons"
where id_utilisateur is not null
group by id_utilisateur
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:40.277128 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:40.278337 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef (execute): 2023-04-01 17:47:40.259542 => 2023-04-01 17:47:40.278268
[0m17:47:40.278725 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: ROLLBACK
[0m17:47:40.279402 [debug] [Thread-1  ]: On test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef: Close
[0m17:47:40.280576 [error] [Thread-1  ]: 3 of 4 FAIL 50 unique_chansons_id_utilisateur .................................. [[31mFAIL 50[0m in 0.03s]
[0m17:47:40.281503 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_chansons_id_utilisateur.1124a727ef
[0m17:47:40.282027 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:40.282311 [info ] [Thread-1  ]: 4 of 4 START test unique_utilisateurs_id_utilisateur ........................... [RUN]
[0m17:47:40.283364 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031'
[0m17:47:40.283765 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:40.291333 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:40.291952 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (compile): 2023-04-01 17:47:40.284061 => 2023-04-01 17:47:40.291845
[0m17:47:40.292268 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:40.295153 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:40.295609 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:40.295905 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: BEGIN
[0m17:47:40.296183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:47:40.306309 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:47:40.306630 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:47:40.307028 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_utilisateur as unique_field,
    count(*) as n_records

from "postgres"."public"."utilisateurs"
where id_utilisateur is not null
group by id_utilisateur
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:40.308476 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:47:40.309849 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (execute): 2023-04-01 17:47:40.292467 => 2023-04-01 17:47:40.309758
[0m17:47:40.310143 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: ROLLBACK
[0m17:47:40.310754 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: Close
[0m17:47:40.311799 [info ] [Thread-1  ]: 4 of 4 PASS unique_utilisateurs_id_utilisateur ................................. [[32mPASS[0m in 0.03s]
[0m17:47:40.312670 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:47:40.314423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:40.315012 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.315367 [debug] [MainThread]: On master: BEGIN
[0m17:47:40.315725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:40.329996 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:47:40.330501 [debug] [MainThread]: On master: COMMIT
[0m17:47:40.330832 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:40.331124 [debug] [MainThread]: On master: COMMIT
[0m17:47:40.331869 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:47:40.332242 [debug] [MainThread]: On master: Close
[0m17:47:40.333189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:40.333513 [debug] [MainThread]: Connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031' was properly closed.
[0m17:47:40.333868 [info ] [MainThread]: 
[0m17:47:40.334778 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:47:40.336047 [debug] [MainThread]: Command end result
[0m17:47:40.343721 [info ] [MainThread]: 
[0m17:47:40.344269 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:47:40.344611 [info ] [MainThread]: 
[0m17:47:40.345082 [error] [MainThread]: [31mFailure in test unique_chansons_id_utilisateur (models/example/schema.yml)[0m
[0m17:47:40.345611 [error] [MainThread]:   Got 50 results, configured to fail if != 0
[0m17:47:40.346521 [info ] [MainThread]: 
[0m17:47:40.346961 [info ] [MainThread]:   compiled Code at target/compiled/sample_dbt/models/example/schema.yml/unique_chansons_id_utilisateur.sql
[0m17:47:40.347500 [info ] [MainThread]: 
[0m17:47:40.348210 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:47:40.348789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb401f85700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4040858e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb404085910>]}
[0m17:47:40.349173 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 17:48:39.543476 | 6a66bccb-7bf8-4fa1-b488-1f08fe466d4c ==============================
[0m17:48:39.543476 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:48:39.545306 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:48:39.545570 [debug] [MainThread]: Tracking: tracking
[0m17:48:39.585019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccaffb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccaffbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccaffb7f0>]}
[0m17:48:39.602203 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:48:39.636754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:39.637377 [debug] [MainThread]: Partial parsing: updated file: sample_dbt://models/example/schema.yml
[0m17:48:39.651846 [warn ] [MainThread]: [[33mWARNING[0m]: 'chansons' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `chansons` specification
under the seeds key instead.
[0m17:48:39.693809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m17:48:39.702661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a66bccb-7bf8-4fa1-b488-1f08fe466d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccae6a190>]}
[0m17:48:39.711342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a66bccb-7bf8-4fa1-b488-1f08fe466d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccaec8ee0>]}
[0m17:48:39.711832 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:48:39.712323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a66bccb-7bf8-4fa1-b488-1f08fe466d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccf717640>]}
[0m17:48:39.713974 [info ] [MainThread]: 
[0m17:48:39.716194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:39.718041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:48:39.737126 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:48:39.737529 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:48:39.737904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:39.750441 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:48:39.750808 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:48:39.751071 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:48:39.754410 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m17:48:39.756658 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:48:39.757367 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:48:39.765720 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.766098 [debug] [MainThread]: On master: BEGIN
[0m17:48:39.766382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:39.775546 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:48:39.775968 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.776237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:39.781819 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:48:39.783948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a66bccb-7bf8-4fa1-b488-1f08fe466d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccaec8910>]}
[0m17:48:39.784375 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:39.785054 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.785344 [debug] [MainThread]: On master: BEGIN
[0m17:48:39.786346 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:48:39.786668 [debug] [MainThread]: On master: COMMIT
[0m17:48:39.786934 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.787183 [debug] [MainThread]: On master: COMMIT
[0m17:48:39.787775 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:48:39.788102 [debug] [MainThread]: On master: Close
[0m17:48:39.788800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:39.789396 [info ] [MainThread]: 
[0m17:48:39.793781 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:48:39.794154 [info ] [Thread-1  ]: 1 of 3 START test not_null_chansons_id_utilisateur ............................. [RUN]
[0m17:48:39.794962 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14'
[0m17:48:39.795327 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:48:39.813139 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:48:39.813719 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (compile): 2023-04-01 17:48:39.795580 => 2023-04-01 17:48:39.813617
[0m17:48:39.814072 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:48:39.838132 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:48:39.838761 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:48:39.839038 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: BEGIN
[0m17:48:39.839265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:39.850331 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:48:39.850673 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:48:39.850915 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."chansons"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:48:39.852359 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:48:39.855323 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (execute): 2023-04-01 17:48:39.814278 => 2023-04-01 17:48:39.855242
[0m17:48:39.855698 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: ROLLBACK
[0m17:48:39.856352 [debug] [Thread-1  ]: On test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14: Close
[0m17:48:39.857192 [info ] [Thread-1  ]: 1 of 3 PASS not_null_chansons_id_utilisateur ................................... [[32mPASS[0m in 0.06s]
[0m17:48:39.858868 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:48:39.859312 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:48:39.859598 [info ] [Thread-1  ]: 2 of 3 START test not_null_utilisateurs_id_utilisateur ......................... [RUN]
[0m17:48:39.860611 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626'
[0m17:48:39.860958 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:48:39.867378 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:48:39.868173 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (compile): 2023-04-01 17:48:39.861200 => 2023-04-01 17:48:39.868004
[0m17:48:39.868700 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:48:39.872758 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:48:39.873402 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:48:39.873802 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: BEGIN
[0m17:48:39.874037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:39.884314 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:48:39.884846 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:48:39.885249 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_utilisateur
from "postgres"."public"."utilisateurs"
where id_utilisateur is null



      
    ) dbt_internal_test
[0m17:48:39.887204 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:48:39.889229 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (execute): 2023-04-01 17:48:39.869010 => 2023-04-01 17:48:39.889153
[0m17:48:39.889672 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: ROLLBACK
[0m17:48:39.890373 [debug] [Thread-1  ]: On test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626: Close
[0m17:48:39.891332 [info ] [Thread-1  ]: 2 of 3 PASS not_null_utilisateurs_id_utilisateur ............................... [[32mPASS[0m in 0.03s]
[0m17:48:39.891979 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:48:39.892607 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:48:39.893012 [info ] [Thread-1  ]: 3 of 3 START test unique_utilisateurs_id_utilisateur ........................... [RUN]
[0m17:48:39.894273 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031'
[0m17:48:39.894883 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:48:39.913187 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:48:39.914360 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (compile): 2023-04-01 17:48:39.895288 => 2023-04-01 17:48:39.914099
[0m17:48:39.915109 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:48:39.919528 [debug] [Thread-1  ]: Writing runtime sql for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:48:39.920470 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:48:39.920901 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: BEGIN
[0m17:48:39.921266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:39.932598 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:48:39.933276 [debug] [Thread-1  ]: Using postgres connection "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:48:39.933776 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_utilisateur as unique_field,
    count(*) as n_records

from "postgres"."public"."utilisateurs"
where id_utilisateur is not null
group by id_utilisateur
having count(*) > 1



      
    ) dbt_internal_test
[0m17:48:39.935655 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m17:48:39.937646 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (execute): 2023-04-01 17:48:39.915626 => 2023-04-01 17:48:39.937573
[0m17:48:39.938083 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: ROLLBACK
[0m17:48:39.938825 [debug] [Thread-1  ]: On test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031: Close
[0m17:48:39.939475 [info ] [Thread-1  ]: 3 of 3 PASS unique_utilisateurs_id_utilisateur ................................. [[32mPASS[0m in 0.05s]
[0m17:48:39.940164 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:48:39.941880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:39.942213 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.942476 [debug] [MainThread]: On master: BEGIN
[0m17:48:39.942732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:39.954519 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:48:39.954884 [debug] [MainThread]: On master: COMMIT
[0m17:48:39.955158 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:39.955413 [debug] [MainThread]: On master: COMMIT
[0m17:48:39.955948 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:48:39.956267 [debug] [MainThread]: On master: Close
[0m17:48:39.957000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:39.957233 [debug] [MainThread]: Connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031' was properly closed.
[0m17:48:39.957497 [info ] [MainThread]: 
[0m17:48:39.957965 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:48:39.958585 [debug] [MainThread]: Command end result
[0m17:48:39.969309 [info ] [MainThread]: 
[0m17:48:39.969882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:39.970567 [info ] [MainThread]: 
[0m17:48:39.971045 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:48:39.971699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc8d9f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc8d9f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc8d9fd00>]}
[0m17:48:39.972220 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 17:54:16.013137 | 68c941dd-6118-4d70-add6-4da39b6b141e ==============================
[0m17:54:16.013137 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:54:16.015011 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:54:16.015275 [debug] [MainThread]: Tracking: tracking
[0m17:54:16.054418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6270b6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6270b6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6270b67f0>]}
[0m17:54:16.072951 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:54:16.086377 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:54:16.086984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68c941dd-6118-4d70-add6-4da39b6b141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd627112f40>]}
[0m17:54:17.209013 [debug] [MainThread]: 1699: static parser successfully parsed total_ecoutes_par_genre.sql
[0m17:54:17.294912 [warn ] [MainThread]: [[33mWARNING[0m]: 'utilisateurs' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `utilisateurs`
specification under the seeds key instead.
[0m17:54:17.297383 [warn ] [MainThread]: [[33mWARNING[0m]: 'chansons' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `chansons` specification
under the seeds key instead.
[0m17:54:17.421760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m17:54:17.431071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c941dd-6118-4d70-add6-4da39b6b141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd627004640>]}
[0m17:54:17.440215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c941dd-6118-4d70-add6-4da39b6b141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62709fdc0>]}
[0m17:54:17.440709 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:54:17.441182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c941dd-6118-4d70-add6-4da39b6b141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62706c100>]}
[0m17:54:17.443767 [info ] [MainThread]: 
[0m17:54:17.446521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:17.448843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m17:54:17.467785 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:54:17.468232 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:54:17.468594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:17.480409 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:54:17.480772 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:54:17.481041 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:54:17.484666 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m17:54:17.486253 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:54:17.487560 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:54:17.497197 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.497536 [debug] [MainThread]: On master: BEGIN
[0m17:54:17.497850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:17.507848 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:17.508240 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.508543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:17.511736 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:54:17.513628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c941dd-6118-4d70-add6-4da39b6b141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd626f94b50>]}
[0m17:54:17.514020 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:17.514567 [debug] [MainThread]: On master: Close
[0m17:54:17.515280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:17.515803 [info ] [MainThread]: 
[0m17:54:17.520517 [debug] [Thread-1  ]: Began running node seed.sample_dbt.chansons
[0m17:54:17.521467 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.sample_dbt.chansons'
[0m17:54:17.521861 [debug] [Thread-1  ]: Began compiling node seed.sample_dbt.chansons
[0m17:54:17.524223 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.chansons (compile): 2023-04-01 17:54:17.522105 => 2023-04-01 17:54:17.524106
[0m17:54:17.524572 [debug] [Thread-1  ]: Began executing node seed.sample_dbt.chansons
[0m17:54:17.524884 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.chansons (execute): 2023-04-01 17:54:17.524781 => 2023-04-01 17:54:17.524798
[0m17:54:17.526712 [debug] [Thread-1  ]: Finished running node seed.sample_dbt.chansons
[0m17:54:17.527133 [debug] [Thread-1  ]: Began running node seed.sample_dbt.utilisateurs
[0m17:54:17.527756 [debug] [Thread-1  ]: Acquiring new postgres connection 'seed.sample_dbt.utilisateurs'
[0m17:54:17.528111 [debug] [Thread-1  ]: Began compiling node seed.sample_dbt.utilisateurs
[0m17:54:17.530240 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.utilisateurs (compile): 2023-04-01 17:54:17.528338 => 2023-04-01 17:54:17.530178
[0m17:54:17.530553 [debug] [Thread-1  ]: Began executing node seed.sample_dbt.utilisateurs
[0m17:54:17.530815 [debug] [Thread-1  ]: Timing info for seed.sample_dbt.utilisateurs (execute): 2023-04-01 17:54:17.530760 => 2023-04-01 17:54:17.530770
[0m17:54:17.531539 [debug] [Thread-1  ]: Finished running node seed.sample_dbt.utilisateurs
[0m17:54:17.532467 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m17:54:17.532984 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m17:54:17.533243 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m17:54:17.536548 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m17:54:17.537152 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 17:54:17.533404 => 2023-04-01 17:54:17.537091
[0m17:54:17.537491 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m17:54:17.537757 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 17:54:17.537697 => 2023-04-01 17:54:17.537708
[0m17:54:17.538808 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m17:54:17.539363 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:54:17.540114 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14'
[0m17:54:17.540518 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:54:17.564055 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14"
[0m17:54:17.564698 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (compile): 2023-04-01 17:54:17.540938 => 2023-04-01 17:54:17.564586
[0m17:54:17.565039 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:54:17.565312 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14 (execute): 2023-04-01 17:54:17.565252 => 2023-04-01 17:54:17.565265
[0m17:54:17.566221 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_chansons_id_utilisateur.2013ad3a14
[0m17:54:17.566857 [debug] [Thread-1  ]: Began running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:54:17.567935 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626'
[0m17:54:17.568371 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:54:17.574923 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626"
[0m17:54:17.575459 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (compile): 2023-04-01 17:54:17.568675 => 2023-04-01 17:54:17.575386
[0m17:54:17.575793 [debug] [Thread-1  ]: Began executing node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:54:17.576087 [debug] [Thread-1  ]: Timing info for test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626 (execute): 2023-04-01 17:54:17.576028 => 2023-04-01 17:54:17.576040
[0m17:54:17.576916 [debug] [Thread-1  ]: Finished running node test.sample_dbt.not_null_utilisateurs_id_utilisateur.52f8390626
[0m17:54:17.577412 [debug] [Thread-1  ]: Began running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:54:17.578158 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031'
[0m17:54:17.578478 [debug] [Thread-1  ]: Began compiling node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:54:17.590085 [debug] [Thread-1  ]: Writing injected SQL for node "test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031"
[0m17:54:17.590649 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (compile): 2023-04-01 17:54:17.578692 => 2023-04-01 17:54:17.590578
[0m17:54:17.591115 [debug] [Thread-1  ]: Began executing node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:54:17.591419 [debug] [Thread-1  ]: Timing info for test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031 (execute): 2023-04-01 17:54:17.591335 => 2023-04-01 17:54:17.591346
[0m17:54:17.592291 [debug] [Thread-1  ]: Finished running node test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031
[0m17:54:17.593253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:17.593538 [debug] [MainThread]: Connection 'test.sample_dbt.unique_utilisateurs_id_utilisateur.bdd4c22031' was properly closed.
[0m17:54:17.594196 [debug] [MainThread]: Command end result
[0m17:54:17.601956 [info ] [MainThread]: Done.
[0m17:54:17.603990 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:54:17.604281 [info ] [MainThread]: Building catalog
[0m17:54:17.606157 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m17:54:17.614710 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m17:54:17.615061 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m17:54:17.615375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:17.639846 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:54:17.640246 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m17:54:17.640538 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:54:17.644624 [debug] [ThreadPool]: SQL status: SELECT 13 in 0 seconds
[0m17:54:17.653933 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m17:54:17.655081 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m17:54:17.665835 [info ] [MainThread]: Catalog written to /home/stefen/dbt/sample_dbt/target/catalog.json
[0m17:54:17.666442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6270b6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6266b48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6266b44f0>]}
[0m17:54:17.666799 [debug] [MainThread]: Flushing usage events
[0m17:54:17.884596 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:54:17.886845 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.


============================== 2023-04-01 17:54:29.698107 | 9105e79a-6fae-444f-943e-29543c8a9c77 ==============================
[0m17:54:29.698107 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:54:29.700791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m17:54:29.701280 [debug] [MainThread]: Tracking: tracking
[0m17:54:29.742093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8880>]}
[0m17:54:29.750289 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m17:54:29.751007 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m17:54:29.751274 [info ] [MainThread]: 
[0m17:54:29.751745 [info ] [MainThread]: 
[0m17:54:29.752231 [info ] [MainThread]: Press Ctrl+C to exit.
[0m17:54:29.752954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7e9ea8c40>]}
[0m17:54:29.753420 [debug] [MainThread]: Flushing usage events
[0m17:54:29.923985 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m17:54:29.939443 [error] [MainThread]: Traceback (most recent call last):
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/site-packages/dbt/main.py", line 136, in main
    results, succeeded = handle_and_check(args)
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/site-packages/dbt/main.py", line 206, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/site-packages/dbt/main.py", line 253, in run_from_args
    results = task.run()
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/site-packages/dbt/task/serve.py", line 30, in run
    httpd = TCPServer(  # type: ignore
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/home/stefen/anaconda3/envs/my_env/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use



============================== 2023-04-01 17:55:38.472756 | ddcdfa7c-d6ba-4e9c-96f6-9040ad93e7e3 ==============================
[0m17:55:38.472756 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:55:38.474560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8081, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m17:55:38.474806 [debug] [MainThread]: Tracking: tracking
[0m17:55:38.515620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aee980730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aee980af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aee980790>]}
[0m17:55:38.519918 [info ] [MainThread]: Serving docs at 0.0.0.0:8081
[0m17:55:38.520734 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8081
[0m17:55:38.521213 [info ] [MainThread]: 
[0m17:55:38.521908 [info ] [MainThread]: 
[0m17:55:38.522533 [info ] [MainThread]: Press Ctrl+C to exit.
[0m18:02:50.993031 [debug] [MainThread]: Flushing usage events
[0m18:02:51.185117 [info ] [MainThread]: ctrl-c


============================== 2023-04-01 18:04:50.414657 | 10fbc6f4-5e1e-4eeb-a971-4c76a425550b ==============================
[0m18:04:50.414657 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:04:50.416616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:04:50.416999 [debug] [MainThread]: Tracking: tracking
[0m18:04:50.459654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed78f5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed78f5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed78f5790>]}
[0m18:04:50.477188 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:04:50.513601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:04:50.514229 [debug] [MainThread]: Partial parsing: added file: sample_dbt://models/total_listening_time.sql
[0m18:04:50.514700 [debug] [MainThread]: Partial parsing: added file: sample_dbt://macros/minutes_to_seconds.sql
[0m18:04:50.539220 [debug] [MainThread]: 1603: static parser failed on total_listening_time.sql
[0m18:04:50.558360 [debug] [MainThread]: 1602: parser fallback to jinja rendering on total_listening_time.sql
[0m18:04:50.566337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:04:50.574984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed6f4f8e0>]}
[0m18:04:50.586434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed77abcd0>]}
[0m18:04:50.587062 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:04:50.587705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edbffc5e0>]}
[0m18:04:50.589756 [info ] [MainThread]: 
[0m18:04:50.592106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:50.593800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:04:50.612622 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:04:50.613218 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:04:50.613737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:50.625876 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:04:50.627135 [debug] [ThreadPool]: On list_postgres: Close
[0m18:04:50.629140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:04:50.640034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:04:50.640553 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:04:50.640952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:50.651914 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:04:50.652513 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:04:50.652980 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:04:50.655705 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:04:50.657549 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:04:50.658360 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:04:50.664295 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.664687 [debug] [MainThread]: On master: BEGIN
[0m18:04:50.664970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:50.675757 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:50.676169 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.676476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:50.679667 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:04:50.680779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed6f002e0>]}
[0m18:04:50.681067 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:50.681597 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.681796 [debug] [MainThread]: On master: BEGIN
[0m18:04:50.682670 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:50.682950 [debug] [MainThread]: On master: COMMIT
[0m18:04:50.683219 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.683471 [debug] [MainThread]: On master: COMMIT
[0m18:04:50.684074 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:04:50.684379 [debug] [MainThread]: On master: Close
[0m18:04:50.685046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:50.685431 [info ] [MainThread]: 
[0m18:04:50.688730 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:04:50.689130 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:04:50.689675 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:04:50.689882 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:04:50.692994 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.693571 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:04:50.690025 => 2023-04-01 18:04:50.693480
[0m18:04:50.693951 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:04:50.759201 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.759796 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.760082 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:04:50.760312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:04:50.770784 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:04:50.771149 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.771391 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:04:50.773613 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:04:50.782520 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.782939 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:04:50.784191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:04:50.787442 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.787860 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:04:50.788817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:04:50.815570 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:04:50.816042 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.816471 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:04:50.843132 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:04:50.851209 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:04:50.851638 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:04:50.855729 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:04:50.857313 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:04:50.694159 => 2023-04-01 18:04:50.857254
[0m18:04:50.857705 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:04:50.858665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed4e3af70>]}
[0m18:04:50.859275 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.17s]
[0m18:04:50.861089 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:04:50.861614 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:04:50.862124 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:04:50.863057 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:04:50.863510 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:04:50.867665 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_listening_time"
[0m18:04:50.868397 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:04:50.863835 => 2023-04-01 18:04:50.868293
[0m18:04:50.868861 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_listening_time
[0m18:04:50.875161 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_listening_time"
[0m18:04:50.876217 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:04:50.876762 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: BEGIN
[0m18:04:50.877388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:04:50.888844 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:04:50.889348 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:04:50.889723 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_listening_time"} */

  create view "postgres"."public"."total_listening_time__dbt_tmp" as (
    -- models/total_listening_time.sql
WITH user_listening_data AS (
  SELECT
    id_utilisateur,
    
  duree_minutes * 60
 as duree_secondes
  FROM
    "postgres"."public"."chansons"
)

SELECT
  id_utilisateur,
  SUM(duree_secondes) as temps_ecoute_total_secondes
FROM
  user_listening_data
GROUP BY
  id_utilisateur
  );
[0m18:04:50.890708 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "duree_minutes" does not exist
LINE 9:   duree_minutes * 60
          ^

[0m18:04:50.891091 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: ROLLBACK
[0m18:04:50.892140 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (execute): 2023-04-01 18:04:50.869191 => 2023-04-01 18:04:50.892068
[0m18:04:50.892548 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: Close
[0m18:04:50.895940 [debug] [Thread-1  ]: Database Error in model total_listening_time (models/total_listening_time.sql)
  column "duree_minutes" does not exist
  LINE 9:   duree_minutes * 60
            ^
  compiled Code at target/run/sample_dbt/models/total_listening_time.sql
[0m18:04:50.896914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10fbc6f4-5e1e-4eeb-a971-4c76a425550b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed4e3ae50>]}
[0m18:04:50.897724 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.03s]
[0m18:04:50.898914 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:04:50.902595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:50.903209 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.903641 [debug] [MainThread]: On master: BEGIN
[0m18:04:50.904036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:50.925423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:50.925788 [debug] [MainThread]: On master: COMMIT
[0m18:04:50.926062 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:50.926320 [debug] [MainThread]: On master: COMMIT
[0m18:04:50.926806 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:04:50.927097 [debug] [MainThread]: On master: Close
[0m18:04:50.927891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:50.928221 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:04:50.928910 [info ] [MainThread]: 
[0m18:04:50.929392 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:04:50.930387 [debug] [MainThread]: Command end result
[0m18:04:50.941004 [info ] [MainThread]: 
[0m18:04:50.941518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:50.941887 [info ] [MainThread]: 
[0m18:04:50.942298 [error] [MainThread]: [33mDatabase Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:04:50.942686 [error] [MainThread]:   column "duree_minutes" does not exist
[0m18:04:50.943042 [error] [MainThread]:   LINE 9:   duree_minutes * 60
[0m18:04:50.943380 [error] [MainThread]:             ^
[0m18:04:50.943930 [error] [MainThread]:   compiled Code at target/run/sample_dbt/models/total_listening_time.sql
[0m18:04:50.944661 [info ] [MainThread]: 
[0m18:04:50.945488 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:04:50.946328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed794d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed4e200d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed77aba60>]}
[0m18:04:50.946976 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:05:02.238900 | fa9dff1b-523c-4e50-ba93-6f75933619c5 ==============================
[0m18:05:02.238900 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:05:02.241056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:05:02.241320 [debug] [MainThread]: Tracking: tracking
[0m18:05:02.283068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3509059670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3509059a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35090596d0>]}
[0m18:05:02.299307 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:05:02.333127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:02.333539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:02.334441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:05:02.343247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508f23340>]}
[0m18:05:02.352382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508f05b80>]}
[0m18:05:02.352997 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:05:02.353727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508f05ca0>]}
[0m18:05:02.355936 [info ] [MainThread]: 
[0m18:05:02.358080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:02.359891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:05:02.382040 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:05:02.382558 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:05:02.382977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:02.396078 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:05:02.398080 [debug] [ThreadPool]: On list_postgres: Close
[0m18:05:02.400275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:05:02.409220 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:05:02.409653 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:05:02.409945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:02.431151 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:05:02.431585 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:05:02.431976 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:05:02.435678 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:05:02.437555 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:05:02.438404 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:05:02.446172 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.446526 [debug] [MainThread]: On master: BEGIN
[0m18:05:02.446801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:02.457895 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:02.458479 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.458957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:02.464694 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:05:02.466345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508f05a00>]}
[0m18:05:02.466738 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:02.467391 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.467572 [debug] [MainThread]: On master: BEGIN
[0m18:05:02.469023 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:02.469440 [debug] [MainThread]: On master: COMMIT
[0m18:05:02.469871 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.470208 [debug] [MainThread]: On master: COMMIT
[0m18:05:02.470994 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:02.471357 [debug] [MainThread]: On master: Close
[0m18:05:02.472349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:02.474980 [info ] [MainThread]: 
[0m18:05:02.485884 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:05:02.486539 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:05:02.487898 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:05:02.489325 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:05:02.494248 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.495008 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:05:02.490121 => 2023-04-01 18:05:02.494872
[0m18:05:02.495494 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:05:02.555585 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.556817 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.557331 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:05:02.557732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:02.566313 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:02.566782 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.567143 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:05:02.570165 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:05:02.578793 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.579260 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:05:02.580224 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:02.583101 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.583344 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:05:02.584059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:02.611633 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:05:02.612133 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.612527 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:05:02.616569 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:05:02.624430 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:05:02.624916 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:05:02.634976 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:05:02.637506 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:05:02.495841 => 2023-04-01 18:05:02.637433
[0m18:05:02.637866 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:05:02.639293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35086ab610>]}
[0m18:05:02.640337 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.15s]
[0m18:05:02.643343 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:05:02.643830 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:05:02.644504 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:05:02.645653 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:05:02.646037 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:05:02.652277 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_listening_time"
[0m18:05:02.652983 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:05:02.646478 => 2023-04-01 18:05:02.652878
[0m18:05:02.653641 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_listening_time
[0m18:05:02.661066 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_listening_time"
[0m18:05:02.662236 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:05:02.662703 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: BEGIN
[0m18:05:02.662954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:02.672532 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:02.673127 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:05:02.673771 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_listening_time"} */

  create view "postgres"."public"."total_listening_time__dbt_tmp" as (
    -- models/total_listening_time.sql
WITH user_listening_data AS (
  SELECT
    id_utilisateur,
    
  duree_minutes * 60
 as duree_secondes
  FROM
    "postgres"."public"."chansons"
)

SELECT
  id_utilisateur,
  SUM(duree_secondes) as temps_ecoute_total_secondes
FROM
  user_listening_data
GROUP BY
  id_utilisateur
  );
[0m18:05:02.674944 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "duree_minutes" does not exist
LINE 9:   duree_minutes * 60
          ^

[0m18:05:02.675267 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: ROLLBACK
[0m18:05:02.676293 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (execute): 2023-04-01 18:05:02.654455 => 2023-04-01 18:05:02.676013
[0m18:05:02.676640 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: Close
[0m18:05:02.678656 [debug] [Thread-1  ]: Database Error in model total_listening_time (models/total_listening_time.sql)
  column "duree_minutes" does not exist
  LINE 9:   duree_minutes * 60
            ^
  compiled Code at target/run/sample_dbt/models/total_listening_time.sql
[0m18:05:02.679052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa9dff1b-523c-4e50-ba93-6f75933619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508679b50>]}
[0m18:05:02.679504 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.03s]
[0m18:05:02.680030 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:05:02.681478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:02.681935 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.682237 [debug] [MainThread]: On master: BEGIN
[0m18:05:02.682572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:02.693551 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:02.693946 [debug] [MainThread]: On master: COMMIT
[0m18:05:02.694224 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:02.694488 [debug] [MainThread]: On master: COMMIT
[0m18:05:02.695041 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:02.695341 [debug] [MainThread]: On master: Close
[0m18:05:02.697270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:02.697538 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:05:02.697814 [info ] [MainThread]: 
[0m18:05:02.698195 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:05:02.698743 [debug] [MainThread]: Command end result
[0m18:05:02.708412 [info ] [MainThread]: 
[0m18:05:02.709177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:02.709654 [info ] [MainThread]: 
[0m18:05:02.710234 [error] [MainThread]: [33mDatabase Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:05:02.712104 [error] [MainThread]:   column "duree_minutes" does not exist
[0m18:05:02.712962 [error] [MainThread]:   LINE 9:   duree_minutes * 60
[0m18:05:02.713484 [error] [MainThread]:             ^
[0m18:05:02.714094 [error] [MainThread]:   compiled Code at target/run/sample_dbt/models/total_listening_time.sql
[0m18:05:02.714601 [info ] [MainThread]: 
[0m18:05:02.715052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:05:02.715614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350869b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508ff9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3508ff9430>]}
[0m18:05:02.716106 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:09:08.101370 | 1db38af1-0656-4db0-b4c3-b2e70abad8fd ==============================
[0m18:09:08.101370 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:09:08.103547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:09:08.103916 [debug] [MainThread]: Tracking: tracking
[0m18:09:08.145793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf281730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf281af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf281790>]}
[0m18:09:08.161434 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:09:08.196203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:09:08.197080 [debug] [MainThread]: Partial parsing: updated file: sample_dbt://macros/minutes_to_seconds.sql
[0m18:09:08.197548 [debug] [MainThread]: Partial parsing: updated file: sample_dbt://models/total_listening_time.sql
[0m18:09:08.222806 [debug] [MainThread]: 1603: static parser failed on total_listening_time.sql
[0m18:09:08.243170 [debug] [MainThread]: 1602: parser fallback to jinja rendering on total_listening_time.sql
[0m18:09:08.251412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:09:08.260063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfae8d72b0>]}
[0m18:09:08.269332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb39885e0>]}
[0m18:09:08.269967 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:09:08.270634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf148250>]}
[0m18:09:08.272746 [info ] [MainThread]: 
[0m18:09:08.275744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:08.277846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:09:08.300192 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:09:08.300594 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:09:08.300918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:08.313212 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:09:08.314480 [debug] [ThreadPool]: On list_postgres: Close
[0m18:09:08.316102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:09:08.326319 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:09:08.326966 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:09:08.327433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:08.336251 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:09:08.337034 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:09:08.337519 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:09:08.340511 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:09:08.342037 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:09:08.342764 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:09:08.350935 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.351261 [debug] [MainThread]: On master: BEGIN
[0m18:09:08.351596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:08.360974 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:08.361389 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.361664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:08.365587 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:09:08.366658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf13af40>]}
[0m18:09:08.366953 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:08.367388 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.367666 [debug] [MainThread]: On master: BEGIN
[0m18:09:08.368396 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:08.368683 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.368954 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.369208 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.369671 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:09:08.369962 [debug] [MainThread]: On master: Close
[0m18:09:08.370618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:08.371035 [info ] [MainThread]: 
[0m18:09:08.374649 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:08.375136 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:09:08.376117 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:09:08.376529 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:08.380245 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.381066 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:09:08.376777 => 2023-04-01 18:09:08.380873
[0m18:09:08.381641 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:08.442876 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.443532 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.443876 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:09:08.444149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:08.453029 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:09:08.453265 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.453535 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:09:08.455173 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:09:08.463478 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.463740 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:09:08.464632 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:09:08.467595 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.467847 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:09:08.468603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:09:08.495038 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:09:08.495349 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.495614 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:09:08.540320 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:09:08.556820 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:08.557278 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:09:08.560372 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:09:08.561822 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:09:08.382071 => 2023-04-01 18:09:08.561757
[0m18:09:08.562091 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:09:08.562709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfac7e6a90>]}
[0m18:09:08.563134 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.19s]
[0m18:09:08.564614 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:08.565115 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:09:08.565565 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:09:08.566542 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:09:08.567024 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:09:08.572805 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:09:08.567307 => 2023-04-01 18:09:08.572713
[0m18:09:08.574654 [debug] [Thread-1  ]: Compilation Error in model total_listening_time (models/total_listening_time.sql)
  'minutes_to_seconds' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:08.575147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1db38af1-0656-4db0-b4c3-b2e70abad8fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfac7e6a90>]}
[0m18:09:08.575699 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.01s]
[0m18:09:08.576283 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:09:08.578166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:08.578743 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.579102 [debug] [MainThread]: On master: BEGIN
[0m18:09:08.579582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:08.590790 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:08.591228 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.591535 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.591971 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.592647 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:09:08.593076 [debug] [MainThread]: On master: Close
[0m18:09:08.594029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:08.594353 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:09:08.594640 [info ] [MainThread]: 
[0m18:09:08.595678 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:09:08.596548 [debug] [MainThread]: Command end result
[0m18:09:08.606783 [info ] [MainThread]: 
[0m18:09:08.607396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:09:08.607937 [info ] [MainThread]: 
[0m18:09:08.608352 [error] [MainThread]: [33mCompilation Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:09:08.610623 [error] [MainThread]:   'minutes_to_seconds' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:08.611271 [info ] [MainThread]: 
[0m18:09:08.611772 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:09:08.612424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf100b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfae01ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfaf2e5eb0>]}
[0m18:09:08.612849 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:09:18.456564 | 10c29b3c-9da8-4491-aff3-8dcb897d656c ==============================
[0m18:09:18.456564 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:09:18.458329 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:09:18.458576 [debug] [MainThread]: Tracking: tracking
[0m18:09:18.509118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6cfe760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6cfeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6cfe7c0>]}
[0m18:09:18.525175 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:09:18.558513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:18.558825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:18.559759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:09:18.569130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6bf1430>]}
[0m18:09:18.578596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6bd4d00>]}
[0m18:09:18.579233 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:09:18.579827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6bd4df0>]}
[0m18:09:18.582067 [info ] [MainThread]: 
[0m18:09:18.584839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:18.586682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:09:18.606655 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:09:18.607023 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:09:18.607312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:18.619387 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:09:18.621122 [debug] [ThreadPool]: On list_postgres: Close
[0m18:09:18.623222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:09:18.632154 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:09:18.632627 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:09:18.632924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:18.642206 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:09:18.642556 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:09:18.642819 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:09:18.645502 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:09:18.647130 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:09:18.647724 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:09:18.655261 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.655741 [debug] [MainThread]: On master: BEGIN
[0m18:09:18.656131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:18.666383 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:18.666730 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.666975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:18.672134 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:09:18.673844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6bccca0>]}
[0m18:09:18.674365 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:18.675136 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.675557 [debug] [MainThread]: On master: BEGIN
[0m18:09:18.676709 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:18.676951 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.677171 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.677379 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.677946 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:09:18.678353 [debug] [MainThread]: On master: Close
[0m18:09:18.679465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:18.680175 [info ] [MainThread]: 
[0m18:09:18.684004 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:18.684463 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:09:18.685507 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:09:18.685854 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:18.690207 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.690900 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:09:18.686086 => 2023-04-01 18:09:18.690796
[0m18:09:18.691332 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:18.748814 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.749353 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.749629 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:09:18.749855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:18.759397 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:09:18.759714 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.760014 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:09:18.761672 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:09:18.769981 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.770256 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:09:18.770947 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:09:18.775300 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.775550 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:09:18.776264 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:09:18.801642 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:09:18.801956 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.802225 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:09:18.806311 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:09:18.812815 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:09:18.813090 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:09:18.815579 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:09:18.817210 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:09:18.691571 => 2023-04-01 18:09:18.817149
[0m18:09:18.817523 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:09:18.818333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6378760>]}
[0m18:09:18.818811 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:09:18.820937 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:09:18.821484 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:09:18.822291 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:09:18.823930 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:09:18.824536 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:09:18.831354 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:09:18.824777 => 2023-04-01 18:09:18.831268
[0m18:09:18.834155 [debug] [Thread-1  ]: Compilation Error in model total_listening_time (models/total_listening_time.sql)
  'minutes_to_seconds' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:18.834852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c29b3c-9da8-4491-aff3-8dcb897d656c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa63787f0>]}
[0m18:09:18.835694 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.01s]
[0m18:09:18.836846 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:09:18.838606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:18.839083 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.839526 [debug] [MainThread]: On master: BEGIN
[0m18:09:18.839761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:18.851287 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:09:18.851825 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.852193 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.852477 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.853399 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:09:18.853701 [debug] [MainThread]: On master: Close
[0m18:09:18.854368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:18.854608 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:09:18.854883 [info ] [MainThread]: 
[0m18:09:18.855398 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:09:18.856324 [debug] [MainThread]: Command end result
[0m18:09:18.870581 [info ] [MainThread]: 
[0m18:09:18.871067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:09:18.871605 [info ] [MainThread]: 
[0m18:09:18.872249 [error] [MainThread]: [33mCompilation Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:09:18.873033 [error] [MainThread]:   'minutes_to_seconds' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:09:18.873649 [info ] [MainThread]: 
[0m18:09:18.874280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:09:18.874896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa63639a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6ccd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa6bbb9d0>]}
[0m18:09:18.875255 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:12:15.415367 | 63d064e3-3896-40cd-b8d2-9338b3ca952e ==============================
[0m18:12:15.415367 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:12:15.417173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:12:15.417414 [debug] [MainThread]: Tracking: tracking
[0m18:12:15.459240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b338790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b338b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b3387f0>]}
[0m18:12:15.476682 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:12:15.489380 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:12:15.489876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b38af70>]}
[0m18:12:16.496214 [debug] [MainThread]: 1699: static parser successfully parsed total_ecoutes_par_genre.sql
[0m18:12:16.511909 [debug] [MainThread]: 1603: static parser failed on total_listening_time.sql
[0m18:12:16.518220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on total_listening_time.sql
[0m18:12:16.575214 [warn ] [MainThread]: [[33mWARNING[0m]: 'utilisateurs' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `utilisateurs`
specification under the seeds key instead.
[0m18:12:16.578099 [warn ] [MainThread]: [[33mWARNING[0m]: 'chansons' is a seed node, but it is specified in the models section of
models/example/schema.yml. To fix this error, place the `chansons` specification
under the seeds key instead.
[0m18:12:16.724177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:12:16.732975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b2cafd0>]}
[0m18:12:16.744261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b338790>]}
[0m18:12:16.744871 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:12:16.745851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b2e61c0>]}
[0m18:12:16.749082 [info ] [MainThread]: 
[0m18:12:16.751450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:16.753368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:12:16.770640 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:16.771075 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:16.771398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:16.784303 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:12:16.785426 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:16.787070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:12:16.812032 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:12:16.812764 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:12:16.813295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:16.823815 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:12:16.824376 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:12:16.824781 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:12:16.828355 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:12:16.830133 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:12:16.830872 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:12:16.838807 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:16.839140 [debug] [MainThread]: On master: BEGIN
[0m18:12:16.839422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:16.848489 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:16.848744 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:16.849026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:16.854132 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:12:16.855849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87b2d0400>]}
[0m18:12:16.856266 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:16.856796 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:16.856978 [debug] [MainThread]: On master: BEGIN
[0m18:12:16.857806 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:16.858114 [debug] [MainThread]: On master: COMMIT
[0m18:12:16.858376 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:16.858627 [debug] [MainThread]: On master: COMMIT
[0m18:12:16.859123 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:12:16.859349 [debug] [MainThread]: On master: Close
[0m18:12:16.860140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:16.860629 [info ] [MainThread]: 
[0m18:12:16.864936 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:16.865410 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:12:16.866298 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:12:16.866800 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:16.870604 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.871189 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:12:16.867032 => 2023-04-01 18:12:16.871108
[0m18:12:16.871547 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:16.935107 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.935684 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.935989 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:12:16.936253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:16.946710 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:12:16.947039 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.947276 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:12:16.949135 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:12:16.957576 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.958049 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:12:16.959031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:12:16.963015 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.963314 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:12:16.964230 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:12:16.990807 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:12:16.991118 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:16.991346 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:12:16.996509 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:12:17.001052 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:17.001358 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:12:17.004148 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:12:17.006191 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:12:16.871757 => 2023-04-01 18:12:17.006126
[0m18:12:17.006490 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:12:17.007344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87a946700>]}
[0m18:12:17.007983 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:12:17.009854 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:17.010304 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:12:17.010702 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:12:17.011551 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:12:17.011954 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:12:17.017103 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:12:17.012171 => 2023-04-01 18:12:17.017013
[0m18:12:17.018938 [debug] [Thread-1  ]: Compilation Error in model total_listening_time (models/total_listening_time.sql)
  'seconds_to_minutes' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:12:17.019429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63d064e3-3896-40cd-b8d2-9338b3ca952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87a946700>]}
[0m18:12:17.020029 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.01s]
[0m18:12:17.020714 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:12:17.023029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:17.023504 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:17.024158 [debug] [MainThread]: On master: BEGIN
[0m18:12:17.024517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:17.036403 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:17.036848 [debug] [MainThread]: On master: COMMIT
[0m18:12:17.037122 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:17.037451 [debug] [MainThread]: On master: COMMIT
[0m18:12:17.037999 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:12:17.038640 [debug] [MainThread]: On master: Close
[0m18:12:17.039586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:17.039963 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:12:17.040374 [info ] [MainThread]: 
[0m18:12:17.040924 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m18:12:17.041681 [debug] [MainThread]: Command end result
[0m18:12:17.052742 [info ] [MainThread]: 
[0m18:12:17.053274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:17.053657 [info ] [MainThread]: 
[0m18:12:17.054112 [error] [MainThread]: [33mCompilation Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:12:17.054646 [error] [MainThread]:   'seconds_to_minutes' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:12:17.055196 [info ] [MainThread]: 
[0m18:12:17.056095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:12:17.056784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8788cdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8788cdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8788cdc70>]}
[0m18:12:17.057370 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:12:26.489865 | 2b66a664-dfc3-4f7c-bd1d-c0dccff026ec ==============================
[0m18:12:26.489865 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:12:26.491818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:12:26.492188 [debug] [MainThread]: Tracking: tracking
[0m18:12:26.553962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd883ba700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd883baac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd883ba760>]}
[0m18:12:26.568358 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:12:26.602984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:26.603467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:26.604523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:12:26.613667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd882873d0>]}
[0m18:12:26.623557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd88269c10>]}
[0m18:12:26.624156 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:12:26.624751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd88269d30>]}
[0m18:12:26.626353 [info ] [MainThread]: 
[0m18:12:26.628466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:26.629994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:12:26.649669 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:12:26.650407 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:12:26.650821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:26.661866 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:12:26.663485 [debug] [ThreadPool]: On list_postgres: Close
[0m18:12:26.666151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:12:26.674485 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:12:26.674861 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:12:26.675145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:26.684536 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:12:26.684886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:12:26.685169 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:12:26.688055 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:12:26.689646 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:12:26.690234 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:12:26.697359 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.697824 [debug] [MainThread]: On master: BEGIN
[0m18:12:26.698222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:26.708068 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:26.708389 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.708639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:26.713587 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:12:26.714697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd88269a90>]}
[0m18:12:26.715182 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:26.715944 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.716182 [debug] [MainThread]: On master: BEGIN
[0m18:12:26.717094 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:26.717501 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.717895 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.718276 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.718899 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:12:26.719149 [debug] [MainThread]: On master: Close
[0m18:12:26.719664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:26.719973 [info ] [MainThread]: 
[0m18:12:26.723340 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:26.723846 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:12:26.724899 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:12:26.725203 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:26.729488 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.730119 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:12:26.725487 => 2023-04-01 18:12:26.730003
[0m18:12:26.730465 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:26.789411 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.789978 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.790263 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:12:26.790495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:26.800177 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:12:26.800548 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.800823 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:12:26.802919 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:12:26.811378 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.811660 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:12:26.812488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:12:26.816883 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.817174 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:12:26.817926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:12:26.843627 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:12:26.843932 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.844219 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:12:26.848404 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:12:26.855170 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:12:26.855466 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:12:26.858314 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:12:26.859811 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:12:26.730682 => 2023-04-01 18:12:26.859751
[0m18:12:26.860120 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:12:26.860874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87a0d700>]}
[0m18:12:26.861355 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:12:26.863389 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:12:26.863945 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:12:26.864403 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:12:26.865516 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:12:26.865878 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:12:26.878386 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:12:26.866245 => 2023-04-01 18:12:26.878255
[0m18:12:26.881419 [debug] [Thread-1  ]: Compilation Error in model total_listening_time (models/total_listening_time.sql)
  'seconds_to_minutes' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:12:26.882018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b66a664-dfc3-4f7c-bd1d-c0dccff026ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd87a0d5b0>]}
[0m18:12:26.882761 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.total_listening_time ............... [[31mERROR[0m in 0.02s]
[0m18:12:26.883754 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:12:26.885389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:26.885647 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.885872 [debug] [MainThread]: On master: BEGIN
[0m18:12:26.886105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:26.896386 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:12:26.896732 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.896955 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.897275 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.898264 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:12:26.898979 [debug] [MainThread]: On master: Close
[0m18:12:26.900277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:26.900808 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:12:26.901292 [info ] [MainThread]: 
[0m18:12:26.901916 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m18:12:26.903009 [debug] [MainThread]: Command end result
[0m18:12:26.922757 [info ] [MainThread]: 
[0m18:12:26.923302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:26.923712 [info ] [MainThread]: 
[0m18:12:26.924443 [error] [MainThread]: [33mCompilation Error in model total_listening_time (models/total_listening_time.sql)[0m
[0m18:12:26.925127 [error] [MainThread]:   'seconds_to_minutes' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:12:26.925742 [info ] [MainThread]: 
[0m18:12:26.926481 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:12:26.927133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd883fcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd88362310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd879f8940>]}
[0m18:12:26.927535 [debug] [MainThread]: Flushing usage events


============================== 2023-04-01 18:13:43.266695 | da3c82b3-972c-4251-9c59-f2104471b5e8 ==============================
[0m18:13:43.266695 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:13:43.268493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/stefen/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:13:43.268749 [debug] [MainThread]: Tracking: tracking
[0m18:13:43.309711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2fa8b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2fa8bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2fa8b970>]}
[0m18:13:43.323371 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:13:43.355871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:43.360295 [debug] [MainThread]: Partial parsing: updated file: sample_dbt://models/total_listening_time.sql
[0m18:13:43.383494 [debug] [MainThread]: 1603: static parser failed on total_listening_time.sql
[0m18:13:43.402876 [debug] [MainThread]: 1602: parser fallback to jinja rendering on total_listening_time.sql
[0m18:13:43.409707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sample_dbt.example
[0m18:13:43.417765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2f0f0e50>]}
[0m18:13:43.428115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2f94dee0>]}
[0m18:13:43.428747 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:13:43.429355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2f9b94c0>]}
[0m18:13:43.432867 [info ] [MainThread]: 
[0m18:13:43.435533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:43.437402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:13:43.455755 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:13:43.456170 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:13:43.456450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:43.469580 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:13:43.471587 [debug] [ThreadPool]: On list_postgres: Close
[0m18:13:43.473761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m18:13:43.483435 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:13:43.484123 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:13:43.484636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:43.494552 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:13:43.495035 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:13:43.495539 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:13:43.498415 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:13:43.499473 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:13:43.500047 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:13:43.505232 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.505567 [debug] [MainThread]: On master: BEGIN
[0m18:13:43.505835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:43.514593 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:13:43.514905 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.515171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:43.520585 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:13:43.522376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2fa4c5b0>]}
[0m18:13:43.522879 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:43.523615 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.523920 [debug] [MainThread]: On master: BEGIN
[0m18:13:43.524968 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:13:43.525291 [debug] [MainThread]: On master: COMMIT
[0m18:13:43.525580 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.525840 [debug] [MainThread]: On master: COMMIT
[0m18:13:43.526482 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:13:43.526710 [debug] [MainThread]: On master: Close
[0m18:13:43.527185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:43.527451 [info ] [MainThread]: 
[0m18:13:43.530922 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_ecoutes_par_genre
[0m18:13:43.531522 [info ] [Thread-1  ]: 1 of 2 START sql view model public.total_ecoutes_par_genre ..................... [RUN]
[0m18:13:43.532767 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_ecoutes_par_genre'
[0m18:13:43.533100 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_ecoutes_par_genre
[0m18:13:43.536938 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.537452 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (compile): 2023-04-01 18:13:43.533322 => 2023-04-01 18:13:43.537374
[0m18:13:43.537801 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_ecoutes_par_genre
[0m18:13:43.594107 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.594645 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.594952 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: BEGIN
[0m18:13:43.595187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:43.605073 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:13:43.605317 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.605471 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */

  create view "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" as (
    WITH ecoutes AS (
    SELECT
        genre,
        SUM(nombre_ecoutes) as total_ecoutes
    FROM "postgres"."public"."chansons"
    GROUP BY genre
)

SELECT
    genre,
    total_ecoutes
FROM ecoutes
ORDER BY total_ecoutes DESC
  );
[0m18:13:43.607194 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:13:43.615089 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.615398 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre" rename to "total_ecoutes_par_genre__dbt_backup"
[0m18:13:43.616301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:13:43.618409 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.618572 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
alter table "postgres"."public"."total_ecoutes_par_genre__dbt_tmp" rename to "total_ecoutes_par_genre"
[0m18:13:43.619190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:13:43.645087 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:13:43.645430 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.645776 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: COMMIT
[0m18:13:43.651023 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:13:43.659136 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_ecoutes_par_genre"
[0m18:13:43.659429 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_ecoutes_par_genre"} */
drop view if exists "postgres"."public"."total_ecoutes_par_genre__dbt_backup" cascade
[0m18:13:43.662159 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:13:43.663771 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_ecoutes_par_genre (execute): 2023-04-01 18:13:43.538005 => 2023-04-01 18:13:43.663708
[0m18:13:43.664134 [debug] [Thread-1  ]: On model.sample_dbt.total_ecoutes_par_genre: Close
[0m18:13:43.665099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2cfd0eb0>]}
[0m18:13:43.665589 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public.total_ecoutes_par_genre ................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:13:43.667467 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_ecoutes_par_genre
[0m18:13:43.667995 [debug] [Thread-1  ]: Began running node model.sample_dbt.total_listening_time
[0m18:13:43.668389 [info ] [Thread-1  ]: 2 of 2 START sql view model public.total_listening_time ........................ [RUN]
[0m18:13:43.669694 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.sample_dbt.total_listening_time'
[0m18:13:43.670053 [debug] [Thread-1  ]: Began compiling node model.sample_dbt.total_listening_time
[0m18:13:43.675232 [debug] [Thread-1  ]: Writing injected SQL for node "model.sample_dbt.total_listening_time"
[0m18:13:43.675789 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (compile): 2023-04-01 18:13:43.670277 => 2023-04-01 18:13:43.675720
[0m18:13:43.676162 [debug] [Thread-1  ]: Began executing node model.sample_dbt.total_listening_time
[0m18:13:43.681419 [debug] [Thread-1  ]: Writing runtime sql for node "model.sample_dbt.total_listening_time"
[0m18:13:43.682062 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:13:43.682317 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: BEGIN
[0m18:13:43.682542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:43.691925 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:13:43.692325 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:13:43.692570 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_listening_time"} */

  create view "postgres"."public"."total_listening_time__dbt_tmp" as (
    -- models/total_listening_time.sql
WITH chansons_utilisateur AS (
  SELECT
    id_utilisateur,
    duree_sec
  FROM "postgres"."public"."chansons"
),

utilisateur_duree AS (
  SELECT
    id_utilisateur,
    SUM(
  duree_sec::FLOAT * 60
) AS duree_totale_sec
  FROM chansons_utilisateur
  GROUP BY id_utilisateur
)

SELECT
  id_utilisateur,
  duree_totale_sec
FROM utilisateur_duree
ORDER BY duree_totale_sec DESC
  );
[0m18:13:43.695136 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:13:43.699497 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:13:43.700032 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_listening_time"} */
alter table "postgres"."public"."total_listening_time__dbt_tmp" rename to "total_listening_time"
[0m18:13:43.701145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:13:43.703697 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: COMMIT
[0m18:13:43.704271 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:13:43.704802 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: COMMIT
[0m18:13:43.707155 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:13:43.710795 [debug] [Thread-1  ]: Using postgres connection "model.sample_dbt.total_listening_time"
[0m18:13:43.711319 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "default", "target_name": "dev", "node_id": "model.sample_dbt.total_listening_time"} */
drop view if exists "postgres"."public"."total_listening_time__dbt_backup" cascade
[0m18:13:43.712293 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:13:43.714330 [debug] [Thread-1  ]: Timing info for model.sample_dbt.total_listening_time (execute): 2023-04-01 18:13:43.676361 => 2023-04-01 18:13:43.714263
[0m18:13:43.714824 [debug] [Thread-1  ]: On model.sample_dbt.total_listening_time: Close
[0m18:13:43.716501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3c82b3-972c-4251-9c59-f2104471b5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2cfd0610>]}
[0m18:13:43.717209 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.total_listening_time ................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:13:43.718056 [debug] [Thread-1  ]: Finished running node model.sample_dbt.total_listening_time
[0m18:13:43.719740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:43.720185 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.720509 [debug] [MainThread]: On master: BEGIN
[0m18:13:43.720771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:43.730727 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:13:43.731411 [debug] [MainThread]: On master: COMMIT
[0m18:13:43.732408 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:43.733055 [debug] [MainThread]: On master: COMMIT
[0m18:13:43.734120 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:13:43.734833 [debug] [MainThread]: On master: Close
[0m18:13:43.735988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:43.736529 [debug] [MainThread]: Connection 'model.sample_dbt.total_listening_time' was properly closed.
[0m18:13:43.737270 [info ] [MainThread]: 
[0m18:13:43.737966 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:13:43.739048 [debug] [MainThread]: Command end result
[0m18:13:43.750323 [info ] [MainThread]: 
[0m18:13:43.751416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:43.752129 [info ] [MainThread]: 
[0m18:13:43.752788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:13:43.753777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2cfaa460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef2f957e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef341996a0>]}
[0m18:13:43.754359 [debug] [MainThread]: Flushing usage events
